geom_line(aes_string(y = y_value, linetype = Cross), size = 1) #+
#    expand_limits(y=c(0, 10)) +
#   #  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#    scale_color_manual(values = c("#228833", "#4477AA")) +
#    theme_bw(base_size = 14) +
#    scale_y_continuous(breaks = pretty_breaks()) +
#    scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#    #  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#    #  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
#    scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#    #  guides(linetype = "none") +
#    theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
return(p)
}
plot_cross_data(cross_data = expdat, y_value = "Total.animals")
expdat$Cross
plot_cross_data <- function(cross_data, y_value) {
p <-   ggplot(cross_data, aes(x = Date, col = Cross)) +
geom_line(aes_string(y = y_value, linetype = Cross), size = 1) #+
#    expand_limits(y=c(0, 10)) +
#   #  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#    scale_color_manual(values = c("#228833", "#4477AA")) +
#    theme_bw(base_size = 14) +
#    scale_y_continuous(breaks = pretty_breaks()) +
#    scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#    #  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#    #  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
#    scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#    #  guides(linetype = "none") +
#    theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
return(p)
}
plot_cross_data(cross_data = expdat, y_value = "Total.animals")
p <-   ggplot(cross_data, aes(x = Date, col = Cross)) +
geom_line(aes_string(y = y_value, linetype = "Cross"), size = 1) #+
plot_cross_data <- function(cross_data, y_value) {
p <-   ggplot(cross_data, aes(x = Date, col = Cross)) +
geom_line(aes_string(y = y_value, linetype = "Cross"), size = 1) #+
#    expand_limits(y=c(0, 10)) +
#   #  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#    scale_color_manual(values = c("#228833", "#4477AA")) +
#    theme_bw(base_size = 14) +
#    scale_y_continuous(breaks = pretty_breaks()) +
#    scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#    #  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#    #  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
#    scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#    #  guides(linetype = "none") +
#    theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
return(p)
}
plot_cross_data(cross_data = expdat, y_value = "Total.animals")
plot_cross_data <- function(cross_data, y_value) {
p <-   ggplot(cross_data, aes(x = Date, col = Cross)) +
geom_line(aes_string(y = y_value, linetype = "Cross"), size = 1) #+
expand_limits(y=c(0, 10)) +
#   #  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
scale_color_manual(values = c("#228833", "#4477AA")) +
theme_bw(base_size = 14) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
return(p)
}
plot_cross_data(cross_data = expdat, y_value = "Total.animals")
plot_cross_data <- function(cross_data, y_value) {
p <-   ggplot(cross_data, aes(x = Date, col = Cross)) +
geom_line(aes_string(y = y_value, linetype = "Cross"), size = 1) +
expand_limits(y=c(0, 10)) +
#   #  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
scale_color_manual(values = c("#228833", "#4477AA")) +
theme_bw(base_size = 14) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
return(p)
}
plot_cross_data(cross_data = expdat, y_value = "Total.animals")
p <-   ggplot(cross_data, aes(x = Date, col = Cross)) +
geom_line(aes_string(y = y_value, linetype = "Cross"), size = 1) +
expand_limits(y=c(0, 10)) +
#   #  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#    scale_color_manual(values = c("#228833", "#4477AA")) +
theme_bw(base_size = 14) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
plot_cross_data <- function(cross_data, y_value) {
p <-   ggplot(cross_data, aes(x = Date, col = Cross)) +
geom_line(aes_string(y = y_value, linetype = "Cross"), size = 1) +
expand_limits(y=c(0, 10)) +
#   #  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#    scale_color_manual(values = c("#228833", "#4477AA")) +
theme_bw(base_size = 14) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
return(p)
}
plot_cross_data(cross_data = expdat, y_value = "Total.animals")
plot_cross_data <- function(cross_data, y_value) {
p <-   ggplot(cross_data, aes(x = Date, col = Cross)) +
geom_line(aes_string(y = y_value, linetype = "Cross"), size = 1) +
expand_limits(y=c(0, 10)) +
#   #  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#    scale_color_manual(values = c("#228833", "#4477AA")) +
theme_bw(base_size = 14) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
#    scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
return(p)
}
plot_cross_data(cross_data = expdat, y_value = "Total.animals")
## for correct date setting
Sys.setlocale("LC_TIME", "C")
## packages needed
library(ggplot2)
library(openxlsx)
library(scales) ## for different linetypes
library(ggpubr) ## for ggarrange
mytheme <- theme_bw() + theme(line = element_line(size = 2))
## read the data
expdat <- read.xlsx("Experiment_table_Ecy_2023.xlsx")
expdat$Date <- convertToDate(expdat$Date)
plot_cross_data <- function(cross_data, y_value) {
p <-   ggplot(cross_data, aes(x = Date, col = Cross)) +
geom_line(aes_string(y = y_value, linetype = "Cross"), size = 1) +
expand_limits(y=c(0, 10)) +
#   #  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#    scale_color_manual(values = c("#228833", "#4477AA")) +
theme_bw(base_size = 14) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
#    scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
return(p)
}
plot_cross_data(cross_data = expdat, y_value = "Total.animals")
plot_cross_data <- function(cross_data, y_value) {
p <-   ggplot(cross_data, aes(x = Date, col = Cross)) +
geom_line(aes_string(y = y_value, linetype = "Cross"), size = 1) +
expand_limits(y=c(0, 10)) +
#   #  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#    scale_color_manual(values = c("#228833", "#4477AA")) +
theme_bw(base_size = 14) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
ggtitle(title)+
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
#    scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
return(p)
}
plot_cross_data(cross_data = expdat, y_value = "Total.animals", title="Total number of animals")
plot_cross_data <- function(cross_data, y_value, title) {
p <-   ggplot(cross_data, aes(x = Date, col = Cross)) +
geom_line(aes_string(y = y_value, linetype = "Cross"), size = 1) +
expand_limits(y=c(0, 10)) +
#   #  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#    scale_color_manual(values = c("#228833", "#4477AA")) +
theme_bw(base_size = 14) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
ggtitle(title)+
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
#    scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
return(p)
}
plot_cross_data(cross_data = expdat, y_value = "Total.animals", title="Total number of animals")
Sys.setlocale("LC_TIME", "C")
library(ggplot2)
library(openxlsx)
library(scales) ## for different linetypes
library(ggpubr) ## for ggarrange
mytheme <- theme_bw() + theme(line = element_line(size = 2))
setwd("/mnt/Work/Research/Projects/Genome/texts/2023_Ecy_phylotranscr_paper/figs_data/EcyLxPB_cross_git/Fig_females")
## read the data
expdat <- read.xlsx("../data/Experiment_table_Ecy_2023.xlsx")
expdat$Date <- convertToDate(expdat$Date)
expdat.crosses <- expdat[expdat$Cross %in% c("LxL",  "LxPB", "PBxPB", "PBxL"), ]
expdat.fems <- expdat[expdat$Cross == "females", ]
ggplot(expdat.fems, aes(x = Date, col = Cross)) +
geom_area(aes(y = `Total.animals`), size = 1, fill ="grey", alpha = .5, col = "NA") +
expand_limits(y=c(0, 10)) +
geom_line(aes(y=`Females.with.visible.eggs`), size=1, col="black") +
geom_point(aes(y=`Females.with.visible.eggs`), size=2, col="black") +
ylab("Ovigerous females") +
#  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#scale_color_manual(values = c("#F0E442", "#66CCEE", "#228833", "#4477AA")) +
theme_bw(base_size = 18) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
## for correct date setting
Sys.setlocale("LC_TIME", "C")
## packages needed
library(ggplot2)
library(openxlsx)
library(scales) ## for different linetypes
library(ggpubr) ## for ggarrange
source("functions.R")
## for correct date setting
Sys.setlocale("LC_TIME", "C")
## packages needed
library(ggplot2)
library(openxlsx)
library(scales) ## for different linetypes
library(ggpubr) ## for ggarrange
source("./functions.R")
setwd("/mnt/Work/Research/Projects/Genome/texts/2023_Ecy_phylotranscr_paper/figs_data/EcyLxPB_cross_git/Figs_crosses")
## for correct date setting
Sys.setlocale("LC_TIME", "C")
## packages needed
library(ggplot2)
library(openxlsx)
library(scales) ## for different linetypes
library(ggpubr) ## for ggarrange
source("./functions.R")
expdat <- read.xlsx("../data/Experiment_table_Ecy_2023.xlsx")
expdat$Date <- convertToDate(expdat$Date)
######
# #png("survival_all.png", width=24, height=16, units="cm", res=300)
# ptotal <-
# plot_cross_data(cross_data = expdat, y_value = "Total.animals", title="Total number of animals") +
#   geom_vline(xintercept = as.Date("2023-06-12"), col = "red3", linetype="1111") +
#   scale_color_manual(values = c("aquamarine", "grey",  "#F0E442", "yellowgreen", "#66CCAA", "#4477AA",  "#228833")) +
#   scale_linetype_manual(values=rep("31", 7))
# #dev.off()
#
# pfem <-
#   plot_cross_data(cross_data = expdat, y_value = "Females.with.visible.eggs", title="Ovigerous females") +
#   geom_vline(xintercept = as.Date("2023-06-12"), col = "red3", linetype="1111") +
#   scale_color_manual(values = c("aquamarine", "grey",  "#F0E442", "yellowgreen", "#66CCAA", "#4477AA",  "#228833")) +
#   scale_linetype_manual(values=rep("31", 7))
#
# pampl <-
# plot_cross_data(cross_data = expdat, y_value = "Amplexuses", title="Amplexuses") +
#   geom_vline(xintercept = as.Date("2023-06-12"), col = "red3", linetype="1111") +
#   scale_color_manual(values = c("aquamarine", "grey",  "#F0E442", "yellowgreen", "#66CCAA", "#4477AA",  "#228833")) +
#   scale_linetype_manual(values=rep("31", 7))
#
# pjuv <-
# plot_cross_data(cross_data = expdat, y_value = "Juveniles", title="Juveniles") +
#   geom_vline(xintercept = as.Date("2023-06-12"), col = "red3", linetype="1111") +
#   scale_color_manual(values = c("aquamarine", "grey",  "#F0E442", "yellowgreen", "#66CCAA", "#4477AA",  "#228833")) +
#   scale_linetype_manual(values=rep("31", 7))
#
# png("cross_2023.png", width = 24, height=16, units="cm", res=400)
# ggarrange(ptotal, pampl, pfem, pjuv,
#           common.legend=TRUE, legend="bottom")
# dev.off()
#
# expdatSel <- expdat[expdat$Cross %in% c("PBxL", "LxPB", "unchosen"), ]
#
# ptotal <-
#   plot_cross_data(cross_data = expdatSel, y_value = "Total.animals", title="Total number of animals") +
# #  geom_vline(xintercept = as.Date("2023-06-12"), col = "red3", linetype="1111") +
#   scale_color_manual(values = c("yellowgreen", "#66CCAA", "#228833")) +
#   scale_linetype_manual(values=rep("31", 7))
# #dev.off()
#
# pfem <-
#   plot_cross_data(cross_data = expdatSel, y_value = "Females.with.visible.eggs", title="Ovigerous females") +
# #  geom_vline(xintercept = as.Date("2023-06-12"), col = "red3", linetype="1111") +
#   scale_color_manual(values = c("yellowgreen", "#66CCAA", "#228833")) +
#   scale_linetype_manual(values=rep("31", 7))
#
# pampl <-
#   plot_cross_data(cross_data = expdatSel, y_value = "Amplexuses", title="Amplexuses") +
# #  geom_vline(xintercept = as.Date("2023-06-12"), col = "red3", linetype="1111") +
#   scale_color_manual(values = c("yellowgreen", "#66CCAA", "#228833")) +
#   scale_linetype_manual(values=rep("31", 7))
#
# pjuv <-
#   plot_cross_data(cross_data = expdatSel, y_value = "Juveniles", title="Juveniles") +
# #  geom_vline(xintercept = as.Date("2023-06-12"), col = "red3", linetype="1111") +
#   scale_color_manual(values = c("yellowgreen", "#66CCAA", "#228833")) +
#  scale_linetype_manual(values=rep("31", 7))
#png("cross_2023_selected.png", width = 24, height=16, units="cm", res=400)
#ggarrange(ptotal, pampl, pfem, pjuv,
#          common.legend=TRUE, legend="bottom")
#dev.off()
######
expdatSel2 <- expdat[expdat$Cross %in% c("PBxL", "LxPB", "PBxPB", "unchosen"), ]
ptotal <-
plot_cross_data(cross_data = expdatSel2, y_value = "Total.animals", title="Total number of animals") +
#  geom_vline(xintercept = as.Date("2023-06-12"), col = "red3", linetype="1111") +
scale_color_manual(values = c("yellowgreen", "#66CCAA", "#4477AA", "#228833")) +
scale_linetype_manual(values=rep("31", 7))
#dev.off()
pfem <-
plot_cross_data(cross_data = expdatSel2, y_value = "Females.with.visible.eggs", title="Ovigerous females") +
#  geom_vline(xintercept = as.Date("2023-06-12"), col = "red3", linetype="1111") +
scale_color_manual(values = c("yellowgreen", "#66CCAA", "#4477AA", "#228833")) +
scale_linetype_manual(values=rep("31", 7))
pampl <-
plot_cross_data(cross_data = expdatSel2, y_value = "Amplexuses", title="Amplexuses") +
#  geom_vline(xintercept = as.Date("2023-06-12"), col = "red3", linetype="1111") +
scale_color_manual(values = c("yellowgreen", "#66CCAA", "#4477AA", "#228833")) +
scale_linetype_manual(values=rep("31", 7))
pjuv <-
plot_cross_data(cross_data = expdatSel2, y_value = "Juveniles", title="Juveniles") +
#  geom_vline(xintercept = as.Date("2023-06-12"), col = "red3", linetype="1111") +
scale_color_manual(values = c("yellowgreen", "#66CCAA", "#4477AA", "#228833")) +
scale_linetype_manual(values=rep("31", 7))
png("cross_2023_selected2.png", width = 24, height=16, units="cm", res=400)
ggarrange(ptotal, pampl, pfem, pjuv,
common.legend=TRUE, legend="bottom")
dev.off()
setwd("/mnt/Work/Research/Projects/Genome/texts/2023_Ecy_phylotranscr_paper/figs_data/EcyLxPB_cross_git/Fig_females")
Sys.setlocale("LC_TIME", "C")
library(ggplot2)
library(openxlsx)
library(scales) ## for different linetypes
library(ggpubr) ## for ggarrange
## tune ggplot theme
expdat.fems$Females.with.visible.eggs.percent <- expdat.fems$Females.with.visible.eggs/expdat.fems$Total.animals
## and in %, as suggested by BE
ggplot(expdat.fems, aes(x = Date, col = Cross)) +
#    geom_area(aes(y = `Total.animals`), size = 1, fill ="grey", alpha = .5, col = "NA") +
#    expand_limits(y=c(0, 10)) +
geom_line(aes(y=`Females.with.visible.eggs.percent`), size=1, col="black") +
geom_point(aes(y=`Females.with.visible.eggs.percent`), size=2, col="black") +
ylab("Ovigerous females") +
#  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#scale_color_manual(values = c("#F0E442", "#66CCEE", "#228833", "#4477AA")) +
theme_bw(base_size = 18) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
expdat.fems$Females.with.visible.eggs.percent <-
expdat.fems$Females.with.visible.eggs/expdat.fems$Total.animals*100
## and in %, as suggested by BE
ggplot(expdat.fems, aes(x = Date, col = Cross)) +
#    geom_area(aes(y = `Total.animals`), size = 1, fill ="grey", alpha = .5, col = "NA") +
#    expand_limits(y=c(0, 10)) +
geom_line(aes(y=`Females.with.visible.eggs.percent`), size=1, col="black") +
geom_point(aes(y=`Females.with.visible.eggs.percent`), size=2, col="black") +
ylab("Ovigerous females") +
#  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#scale_color_manual(values = c("#F0E442", "#66CCEE", "#228833", "#4477AA")) +
theme_bw(base_size = 18) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
## and in %, as suggested by BE
ggplot(expdat.fems, aes(x = Date, col = Cross)) +
#    geom_area(aes(y = `Total.animals`), size = 1, fill ="grey", alpha = .5, col = "NA") +
#    expand_limits(y=c(0, 10)) +
geom_line(aes(y=`Females.with.visible.eggs.percent`), size=1, col="black") +
geom_point(aes(y=`Females.with.visible.eggs.percent`), size=2, col="black") +
ylab("Ovigerous females, %") +
#  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#scale_color_manual(values = c("#F0E442", "#66CCEE", "#228833", "#4477AA")) +
theme_bw(base_size = 18) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
ggsave("Ecy_females_percent_draft.svg")
ggsave("Ecy_females_percent_draft.svg", width = 12.5, height = 5)
Sys.setlocale("LC_TIME", "C")
library(ggplot2)
library(openxlsx)
library(scales) ## for different linetypes
library(ggpubr) ## for ggarrange
## tune ggplot theme
## scale_color_manual(values=c(
## "#000000", "#E69F00", "#56B4E9", "#009E73",
## "#F0E442", "#0072B2", "#D55E00", "#CC79A7"))
## black    orange  sky_blue    green
## yellow   blue    vermilion   reddish_purple
mytheme <- theme_bw() + theme(line = element_line(size = 2))
## read the data
expdat <- read.xlsx("../data/Experiment_table_Ecy_2023.xlsx")
expdat$Date <- convertToDate(expdat$Date)
expdat.crosses <- expdat[expdat$Cross %in% c("LxL",  "LxPB", "PBxPB", "PBxL"), ]
expdat.fems <- expdat[expdat$Cross == "females", ]
ggplot(expdat.fems, aes(x = Date, col = Cross)) +
geom_area(aes(y = `Total.animals`), size = 1, fill ="grey", alpha = .5, col = "NA") +
expand_limits(y=c(0, 10)) +
geom_line(aes(y=`Females.with.visible.eggs`), size=1, col="black") +
geom_point(aes(y=`Females.with.visible.eggs`), size=2, col="black") +
ylab("Ovigerous females") +
#  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#scale_color_manual(values = c("#F0E442", "#66CCEE", "#228833", "#4477AA")) +
theme_bw(base_size = 18) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
ggsave("Ecy_females_draft.svg", width = 12.5, height = 5.2)
expdat.fems$Females.with.visible.eggs.percent <-
expdat.fems$Females.with.visible.eggs/expdat.fems$Total.animals*100
## and in %, as suggested by BE
ggplot(expdat.fems, aes(x = Date, col = Cross)) +
#    geom_area(aes(y = `Total.animals`), size = 1, fill ="grey", alpha = .5, col = "NA") +
#    expand_limits(y=c(0, 10)) +
geom_line(aes(y=`Females.with.visible.eggs.percent`), size=1, col="black") +
geom_point(aes(y=`Females.with.visible.eggs.percent`), size=2, col="black") +
ylab("Ovigerous females, %") +
#  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#scale_color_manual(values = c("#F0E442", "#66CCEE", "#228833", "#4477AA")) +
theme_bw(base_size = 18) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
ggsave("Ecy_females_percent_draft.svg", width = 12.5, height = 5.2)
Sys.setlocale("LC_TIME", "C")
library(ggplot2)
library(openxlsx)
library(scales) ## for different linetypes
library(ggpubr) ## for ggarrange
## tune ggplot theme
## scale_color_manual(values=c(
## "#000000", "#E69F00", "#56B4E9", "#009E73",
## "#F0E442", "#0072B2", "#D55E00", "#CC79A7"))
## black    orange  sky_blue    green
## yellow   blue    vermilion   reddish_purple
mytheme <- theme_bw() + theme(line = element_line(size = 2))
## read the data
expdat <- read.xlsx("../data/Experiment_table_Ecy_2023.xlsx")
expdat$Date <- convertToDate(expdat$Date)
expdat.crosses <- expdat[expdat$Cross %in% c("LxL",  "LxPB", "PBxPB", "PBxL"), ]
expdat.fems <- expdat[expdat$Cross == "females", ]
ggplot(expdat.fems, aes(x = Date, col = Cross)) +
geom_area(aes(y = `Total.animals`), size = 1, fill ="grey", alpha = .5, col = "NA") +
expand_limits(y=c(0, 10)) +
geom_line(aes(y=`Females.with.visible.eggs`), size=1, col="black") +
geom_point(aes(y=`Females.with.visible.eggs`), size=2, col="black") +
ylab("Ovigerous females") +
#  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#scale_color_manual(values = c("#F0E442", "#66CCEE", "#228833", "#4477AA")) +
theme_bw(base_size = 18) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
ggsave("Ecy_females_draft.svg", width = 16, height = 5.2)
expdat.fems$Females.with.visible.eggs.percent <-
expdat.fems$Females.with.visible.eggs/expdat.fems$Total.animals*100
## and in %, as suggested by BE
ggplot(expdat.fems, aes(x = Date, col = Cross)) +
#    geom_area(aes(y = `Total.animals`), size = 1, fill ="grey", alpha = .5, col = "NA") +
#    expand_limits(y=c(0, 10)) +
geom_line(aes(y=`Females.with.visible.eggs.percent`), size=1, col="black") +
geom_point(aes(y=`Females.with.visible.eggs.percent`), size=2, col="black") +
ylab("Ovigerous females, %") +
#  scale_color_manual(values = c("#4477AA", "#66CCEE", "#228833", "#F0E442")) +
#scale_color_manual(values = c("#F0E442", "#66CCEE", "#228833", "#4477AA")) +
theme_bw(base_size = 18) +
scale_y_continuous(breaks = pretty_breaks()) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
#  scale_linetype_manual(values = c("solid", "212151", "57", "solid")) +
#  scale_linetype_manual(values = c("1234", "21", "31", "11")) +
scale_linetype_manual(values = c("1234", "21", "2111", "31")) +
#  guides(linetype = "none") +
theme(legend.position = 'bottom', legend.key.width = unit(1, "cm"))
ggsave("Ecy_females_percent_draft.svg", width = 16, height = 5.2)
